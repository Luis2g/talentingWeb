<style>
    .borderless {
        border: none;
        background: none;
    }
</style>

<div class="col py-3 mt-3">
    <div class="container">
        <div class="row">

            <div class="col-12" ng-init="consultarLista()">
                <h3 class="display-6" style="display: inline;">Lista</h3>
                <button class="btn btn-outline-dark ms-4" data-bs-toggle="modal" data-bs-target="#listaModal">Añadir</button>
                <hr>
                <table class="table table-striped- table-responsive">
                    <thead>
                        <tr>
                            <th class="text-center">#</th>
                            <th class="text-start">Lista</th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="lista in listas">
                            <td class="text-center">{{$index+1}}</td>
                            <td ng-bind="lista.name"></td>
                            <td class="text-center"> 
                                <button class="btn btn-outline-warning" ng-click="consultarListaPorId(lista)">Editar</button> 
                                <button class="btn btn-outline-primary" ng-click="consultarContacto(lista)">Contactos</button>
                                <button class="btn btn-outline-dark" ng-click="agregarContacto(lista)">Agregar contacto</button> 
                                <button class="btn btn-outline-danger" ng-click="eliminarLista(lista.id)">Eliminar</button> 
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr ng-if="listas.lenght < 1 || listas === null">
                            <td colspan="4" class="text-center fst-italic">Sin listas</td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <div class="col-12" ng-init="consultarCampania()">
                <h3 class="display-6" style="display: inline;">Campaña</h3>
                <button class="btn btn-outline-dark ms-4" data-bs-toggle="modal" data-bs-target="#agregarCampania">Añadir</button>
                <hr>
                <table class="table table-striped- table-responsive">
                    <thead>
                        <tr>
                            <th class="text-center">#</th>
                            <th class="text-start">Campania</th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="campania in campanias">
                            <td class="text-center">{{$index+1}}</td>
                            <td ng-bind="campania.name"></td>
                            <td class="text-center"> 
                                <button class="btn btn-outline-info" ng-click="consultarCampaniaPorId(campania)">Asignar Lista</button> 
                                <button class="btn btn-outline-primary" ng-click="consultarPlantillaCampania(campania)">Asignar Plantilla</button>
                                <button class="btn btn-outline-info" ng-click="consultarDetallesCampania(campania)">Detalles</button> 
                                <button class="btn btn-outline-dark" ng-click="enviarCorreos(campania)">Enviar correos</button> 
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr ng-if="campanias.lenght < 1 || campanias === null">
                            <td colspan="3" class="text-center fst-italic">Sin campañas</td>
                        </tr>
                    </tfoot>
                </table>
            </div>


            
        </div>
    </div>
</div>

<div class="modal fade" id="listaModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Nueva lista</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="example@email.com" ng-model="nombreLista">
                    <label for="floatingInput">Nombre de la lista</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" ng-click="guardarLista()">Guardar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="actualizarLista" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Actualizar lista</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="example@email.com" ng-model="listaActualizar.name">
                    <label for="floatingInput">Nombre de la lista</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-warning" style="color: #fff;" ng-click="actualizarLista(listaActualizar)">Actualizar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="consultarContacto" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Consultar contacto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <table class="table table-striped- table-responsive">
                    <thead>
                        <tr>
                            <th class="text-center">#</th>
                            <th class="text-start">Correo</th>
                            <th class="text-start">Telefono</th>
                            <th class="text-start">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="contacto in contactos">
                            <td class="text-center">{{$index+1}}</td>
                            <td ng-bind="contacto.email"></td>
                            <td ng-bind="contacto.phone"></td>
                            <td class="text-center"> 
                                <button class="btn btn-outline-warning" ng-click="consultarContactoPorId(contacto)">Editar</button> 
                                <button class="btn btn-outline-danger" ng-click="eliminarContacto(contacto)">Eliminar</button>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr ng-if="contactos.lenght < 1 || contactos === null">
                            <td colspan="4" class="text-center fst-italic">Sin contactos</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="contactoModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Nuevo contacto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="floatingInput" placeholder="name@example.com" ng-model="contacto.email">
                    <label for="floatingInput">Correo</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com" ng-model="contacto.telefono" maxlength="10">
                    <label for="floatingInput">Telefono</label>
                </div>
                <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example" ng-options="lista.name for lista in listas track by lista.id" ng-model="contacto.lista" disabled>
                    </select>
                    <label for="floatingSelect">Lista</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" ng-click="guardarContacto(contacto)">Guardar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="actualizarContacto" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Actualizar contacto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="floatingInput" placeholder="name@example.com" ng-model="contactoActualizado.email">
                    <label for="floatingInput">Correo</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="7776010373" ng-model="contactoActualizado.phone" maxlength="10">
                    <label for="floatingInput">Telefono</label>
                </div>
                <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example" ng-options="lista.name for lista in listas track by lista.id" ng-model="contactoActualizado.listaSeleccionadaContacto" disabled>
                    </select>
                    <label for="floatingSelect">Lista</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-warning" ng-click="actualizarContacto(contactoActualizado)">Actualizar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="agregarCampania" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Nueva campaña</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="example@email.com" ng-model="campania.nombre">
                    <label for="floatingInput">Nombre de la campaña</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="floatingInput" placeholder="example@email.com" ng-model="campania.email">
                    <label for="floatingInput">Correo donde se enviara</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="example@email.com" ng-model="campania.alias">
                    <label for="floatingInput">Alias del correo</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="floatingInput" placeholder="example@email.com" ng-model="campania.asunto">
                    <label for="floatingInput">Asunto del correo</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" ng-click="guardarCampania(campania)">Guardar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="asignarLista" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Asignar lista</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example" ng-options="lista.name for lista in listas track by lista.id" ng-model="asignarLista.listaSeleccionadaCampania">
                        <option value="" selected>Seleccione...</option>
                    </select>
                    <label for="floatingSelect">Lista</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" ng-click="asignarListaCampania(asignarLista.listaSeleccionadaCampania)">Asignar</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="detallesCampania" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Detalles campania</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <table class="table table-striped- table-responsive">
                    <thead>
                        <tr>
                            <th class="text-center">#</th>
                            <th class="text-start">Nombre</th>
                            <th class="text-start">Cuentas validas</th>
                            <!-- <th class="text-start">Acciones</th> -->
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="detalle in detallesDeCampania">
                            <td class="text-center">{{$index+1}}</td>
                            <td ng-bind="detalle.name"></td>
                            <td ng-bind="detalle.countValid"></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr ng-if="detallesDeCampania.lenght < 1 || detallesDeCampania === null">
                            <td colspan="4" class="text-center fst-italic">Sin detalles</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="asignarPlantilla" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Asignar plantilla</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example" ng-options="plantilla.name for plantilla in plantillas track by plantilla.id" ng-model="asignarPlantilla">
                        <option value="" hidden>Seleccione...</option>
                    </select>
                    <label for="floatingSelect">Lista</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" ng-click="asignarPlantillaCampania(asignarPlantilla)">Asignar</button>
            </div>
        </div>
    </div>
</div>